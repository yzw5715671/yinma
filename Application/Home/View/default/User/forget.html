<extend name="Base/common" />
<block name="style">
<link href="__CSS__/login.css" rel="stylesheet">
</block>
<block name="body">
 <div class="pagetag"><a href="{:U('Index/index')}">首页</a> > <a href="{:U('User/login')}">登陆</a> > 忘记密码</div>
<div class="findback-psw-container">
  <form method="post" class="form" action="{:U()}">
    <div style="position: relative;margin-top: 20px;">
    <div id="errormessage" style="margin-top:-52px;text-align:left"></div>
      <div class="form-item">
        <input type="text" class="c1" name="mobile" datatype="n11-11" nullmsg="请输入手机号码" maxlength="11" errormsg="手机号码必须为11位数字" placeholder="请输入您注册时使用的手机号" id="phoneNo" value="">
      </div>
      <div class="form-item">
          <img class="send-register-code " style="width:160px;margin-top: 0px;" id="getImgcode" alt="点击切换" src="{:U('verify1')}">
          <input type="text" name="verify" placeholder="图片验证码"
                 style="width:250px;"
                 datatype="*" nullmsg="请输入图片验证码">
          <input type="hidden" name='sms_type' value="forget" />
      </div>
      <div class="form-item">
        <input type="password" name="password" class="c1" datatype="*6-16" nullmsg="请输入新密码" errormsg="新密码至少6个字符，最多16个字符" placeholder="输入新密码">
      </div>
      <div class="form-item"> <a href="__CONTROLLER__/sendsms/sms_type/forget" id="numclick" title="发送验证码" class="get-rancode getsmscode">发送验证码</a>
        <input type="text" class="c1" name="code" placeholder="验证码" datatype="n" nullmsg="请输入验证码" maxlength="6" style="width:254px;">
      </div>
      <div class="form-item"> <button class="findback-psw-btn" style="width: 97%;" type="submit">确定</button> </div>
    </div>
  </form>
</div>
</block>
<block name="script">
<script type="text/javascript" src="__JS__/sms.js"></script>
<script type="text/javascript" src="__STATIC__/Validform_v5.3.2.js"></script>
<script type="text/javascript">
  var captcha_img = $('#getImgcode');
  var verifyimg = captcha_img.attr("src");
  captcha_img.attr('title', '点击刷新');
  captcha_img.click(function(){
      if( verifyimg.indexOf('?')>0){
          $(this).attr("src", verifyimg+'&random='+Math.random());
      }else{
          $(this).attr("src", verifyimg.replace(/\?.*$/,'')+'?'+Math.random());
      }
  });
  $(".form").Validform({
    tiptype: function(msg, o, cssctl) {
      var objtip = $("#errormessage");
      cssctl(objtip, o.type);
      objtip.text(msg);
    }, ajaxPost: true,
    callback: function(data) {
      if (data.status == 1) {
        window.location.href = data.url;
      }
    }
  });
</script>
</block>
